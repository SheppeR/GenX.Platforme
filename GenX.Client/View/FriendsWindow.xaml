<Window
    x:Class="GenX.Client.View.FriendsWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.inkore.net/lib/ui/wpf/modern"
    Width="400"
    Height="650"
    MaxWidth="400"
    ui:ThemeManager.IsThemeAware="True"
    ui:TitleBar.Height="36"
    ui:WindowHelper.ApplyNoise="True"
    ui:WindowHelper.CornerStyle="DoNotRound"
    ui:WindowHelper.SystemBackdropType="Acrylic11"
    ui:WindowHelper.UseModernWindowStyle="True"
    DataContext="{Binding FriendsWindow, Source={StaticResource Locator}}"
    ResizeMode="CanResizeWithGrip"
    mc:Ignorable="d">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid
            Grid.Row="0"
            Margin="15,30,15,5"
            DataContext="{Binding User, Source={StaticResource Locator}}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <Border
                Grid.Column="0"
                Margin="5"
                Background="{Binding Status, Converter={StaticResource StatusToBrushConverter}}">
                <Image
                    Width="55"
                    Height="55"
                    Margin="2"
                    Source="{Binding Avatar, TargetNullValue='pack://application:,,,/Assets/default_avatar.png'}" />
            </Border>
            <StackPanel
                Grid.Column="1"
                Margin="5,0,0,0"
                VerticalAlignment="Center">
                <TextBlock
                    FontWeight="Bold"
                    Foreground="{Binding Status, Converter={StaticResource StatusToBrushConverter}}"
                    Text="{Binding Pseudo}" />
                <TextBlock
                    FontSize="12"
                    Foreground="{Binding Status, Converter={StaticResource StatusToBrushConverter}}"
                    Text="{Binding Status, Converter={StaticResource StatusToStringConverter}}" />
                <TextBlock
                    FontSize="12"
                    Foreground="{Binding Status, Converter={StaticResource StatusToBrushConverter}}"
                    Text="{Binding Event}" />
            </StackPanel>
        </Grid>
        <Separator Grid.Row="1" Margin="15,5,15,5" />
        <ui:ScrollViewerEx
            Grid.Row="2"
            AutoHideScrollBars="True"
            VerticalScrollBarVisibility="Auto">
            <ui:ListView
                Margin="15,5,15,5"
                ItemsSource="{Binding Friends}"
                PreviewMouseWheel="OnPreviewMouseWheel"
                SelectionMode="Single">


                <ui:ListView.ItemTemplate>
                    <DataTemplate>
                        <Grid Height="65">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Border
                                Grid.Column="0"
                                Margin="5"
                                Background="{Binding Status, Converter={StaticResource StatusToBrushConverter}}">
                                <Image
                                    Width="55"
                                    Height="55"
                                    Margin="2"
                                    Source="{Binding Avatar, TargetNullValue='pack://application:,,,/Assets/default_avatar.png'}" />
                            </Border>
                            <StackPanel
                                Grid.Column="1"
                                Margin="5,0,0,0"
                                VerticalAlignment="Center">
                                <TextBlock
                                    FontWeight="Bold"
                                    Foreground="{Binding Status, Converter={StaticResource StatusToBrushConverter}}"
                                    Text="{Binding Pseudo}" />
                                <TextBlock
                                    FontSize="12"
                                    Foreground="{Binding Status, Converter={StaticResource StatusToBrushConverter}}"
                                    Text="{Binding Status, Converter={StaticResource StatusToStringConverter}}" />
                                <TextBlock
                                    FontSize="12"
                                    Foreground="{Binding Status, Converter={StaticResource StatusToBrushConverter}}"
                                    Text="{Binding Event}" />
                            </StackPanel>

                            <StackPanel
                                Grid.Column="2"
                                Margin="5,0,0,0"
                                VerticalAlignment="Top"
                                Orientation="Horizontal"
                                Visibility="{Binding IsAccepted, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                                <ui:AppBarButton
                                    Width="40"
                                    Height="40"
                                    Command="{Binding DataContext.AcceptFriendCommand, RelativeSource={RelativeSource AncestorType={x:Type ui:ListView}}}"
                                    CommandParameter="{Binding ID}">
                                    <ui:AppBarButton.Icon>
                                        <ui:FontIcon
                                            FontSize="20"
                                            Foreground="GreenYellow"
                                            Icon="{x:Static ui:SegoeFluentIcons.CheckMark}" />
                                    </ui:AppBarButton.Icon>
                                </ui:AppBarButton>
                                <ui:AppBarButton
                                    Width="40"
                                    Height="40"
                                    Command="{Binding DataContext.DenyFriendCommand, RelativeSource={RelativeSource AncestorType={x:Type ui:ListView}}}"
                                    CommandParameter="{Binding ID}">
                                    <ui:AppBarButton.Icon>
                                        <ui:FontIcon
                                            FontSize="20"
                                            Foreground="Red"
                                            Icon="{x:Static ui:SegoeFluentIcons.Clear}" />
                                    </ui:AppBarButton.Icon>
                                </ui:AppBarButton>
                            </StackPanel>
                        </Grid>
                    </DataTemplate>
                </ui:ListView.ItemTemplate>
            </ui:ListView>
        </ui:ScrollViewerEx>
    </Grid>
</Window>